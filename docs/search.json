[{"path":"http://emvolz-phylodynamics.github.io/musseco/articles/musseco.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Estimating fitness using BiSSeCO","text":"vignette demonstrate estimate within-host -host transmission fitness using package musseco BiSSeCo (Binary-State Speciation extinction Coalescent) model.","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/articles/musseco.html","id":"basic-requirements","dir":"Articles","previous_headings":"","what":"Basic requirements","title":"Estimating fitness using BiSSeCO","text":"vignette assumes following packages already installed: musseco: implements likelihood function estimate fitness. ape: used manipulation phylogenetic trees. TiPS: used simulate phylogenetic tree according epidemiological model. ggplot2: used visualize results.","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/articles/musseco.html","id":"load-the-necessary-packages","dir":"Articles","previous_headings":"Basic requirements","what":"Load the necessary packages:","title":"Estimating fitness using BiSSeCO","text":"","code":"library(musseco)   library(TiPS)   library(ape)   library(ggplot2)"},{"path":"http://emvolz-phylodynamics.github.io/musseco/articles/musseco.html","id":"simulated-phylogenetic-tree","dir":"Articles","previous_headings":"","what":"Simulated phylogenetic tree","title":"Estimating fitness using BiSSeCO","text":"illustrate can use R package musseco estimate relative fitness, use tree simulated R package TiPS. tree can load :","code":"tr <- readRDS(system.file(\"extdata/tips_params_1_rep_2.rds\", package = \"musseco\"))"},{"path":"http://emvolz-phylodynamics.github.io/musseco/articles/musseco.html","id":"epidemiological-model","dir":"Articles","previous_headings":"Simulated phylogenetic tree","what":"Epidemiological model","title":"Estimating fitness using BiSSeCO","text":"tree simulate way know true values within-host -host replicative fitness. epidemiological model used described following equations, describing number individuals carrying ancestral (\\(Y_a\\)) variant (\\(Y_v\\)) sequences changes time. \\(\\dot{Y_a} = \\beta Y_a (1 - \\dfrac{N}{K}) + \\mu_{va}Y_v - \\mu_{av}Y_a - \\gamma Y_a\\) \\(\\dot{Y_v} = \\beta(1+s)Y_v (1 - \\dfrac{N}{K}) - \\mu_{va}Y_v + \\mu_{av}Y_a - \\gamma Y_v\\) rate new infections defined logistic growth controlled parameter \\(\\beta\\) \\(Y_a(t)\\) \\(\\beta(1+s)\\), \\(s\\) selection coefficient, \\(Y_v(t)\\). carry capacity defined parameter \\(K\\) fixed 10,000 individuals. rate \\(\\mu_{av}\\) defined individuals carrying ancestral state \\(Y_a(t)\\) mutated \\(Y_v(t)\\). rate \\(\\mu_{va}\\) defined individuals carrying variant mutation reversed ancestral state, also molecular clock rate evolution. rate \\(\\gamma\\) denoted mortality rate. vignette focus tree simulated, scripts simulate tree can found . Table 1 shows parameter values used simulate tree Table 1: Parameter symbols values Based parameter values, know true value \\(\\alpha\\) \\(\\omega\\). Note \\(\\alpha = \\mu_{av}/\\mu_{va}\\) \\(\\omega = 1 + s\\).","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/articles/musseco.html","id":"estimation-of-parameter-values-using-fitbisseco","dir":"Articles","previous_headings":"","what":"Estimation of parameter values using fitbisseco","title":"Estimating fitness using BiSSeCO","text":"estimate within-host -host replicative fitness using simulated phylogenetic tree, use function fitbisseco musseco package. Note need define tips phylogenetic tree carries variant state. also need define value mu, molecular clock rate evolution. example, used rate HIV-1 subtype C (Patiño-Galindo JÁ 2017) modelling HIV-1 dynamics. also need define generation time (Tg). generation time can defined \\(1/\\gamma\\). Based Table 1, know values mu gamma. Now can run fitbisseco function using following command: Note following options: tr ape::phylo object, must time-scaled phylogeny. isvariant vector type boolean lentgh equal number tips phylogenetic tree. element TRUE corresponding element tr$tip.label variant type. Tg generation time, .e. mean time elapsed generations. mu molecular clock rate evolution; Net (default NULL): user can also provide matrix two columns giving effective population size. NULL, effective population size computed mlesky R package. first column time since point past, second column estimate effective population size. Time zero correspond root tree. theta0: Initial guess (log) parameter values: alpha, omega, Ne scale. details parameters see ?musseco::fitbisseco. user can also provide additional parameter values use optim fitting model maximum likelihood, mlskygrid function mlesky R package colik function phydynR package. addition, fitbisseco function implements two types likelihoods: ‘coalescent’ ‘augmented’ likelihood. methods based conditional density genealogy given epidemic demographic parameters. coalescent likelihood (setting augment_likelihood = FALSE) relies solely phylogenetic tree infer fitness parameters. augmented likelihood combines simple sum, coalescent likelihood binomial likelihood sampling variants ancestral types assumption random sampling mutation-selection balance. augmented likelihood default option fitbisseco function.","code":"isvariant <- grepl( tr$tip.label, pattern = 'V_' ) isvariant <- setNames(isvariant, tr$tip.label) # gamma value used in our epidemiological model #Tg = 1/gamma gamma <- 1/10.2 # mu (molecular clock) value used in our epidemiological model mu <- 0.0016 fb_au <- fitbisseco( tr,                      isvariant,                      Tg = 1/gamma,                      mu = mu,                      Net = NULL,                      theta0 = log(c(2,.75,1/2)),                      augment_likelihood = TRUE,                      optim_parms = list(),                      mlesky_parms = list(tau = NULL,                                          tau_lower = 0.1,                                          tau_upper = 1e7,                                          ncpu = 1,                                           model = 1 ) )"},{"path":"http://emvolz-phylodynamics.github.io/musseco/articles/musseco.html","id":"obtaining-the-estimated-parameter-values","dir":"Articles","previous_headings":"Estimation of parameter values using fitbisseco","what":"Obtaining the estimated parameter values","title":"Estimating fitness using BiSSeCO","text":"fitbisseco function take minutes run. can load fit can now plot alpha omega respect true values listed Table 1. true values used simulate phylogenetic tree. First need get confidence interval data.frame. Plot can plot values alpha omega using ggplot. Figure 1: Bar plots showing confidence interval estimates alpha omega. Blue dot true value","code":"load(system.file(\"extdata/fit.rda\", package = \"musseco\"))  fb_au #> Binary state speciation and extinction coalescent fit #>  #>               2.5% 97.5% #> alpha  0.910 0.570 1.453 #> omega  0.918 0.874 0.964 #> yscale 0.844 0.769 0.926 #>  #> Likelihood: -5331.4195 # threshold for approximate CIs  MAXCOEFVAR <- 1.5  #variable names   vnames <-  c('alpha', 'omega', 'yscale') #the best values for the parameters found using optim best_values <- coef(fb_au)[vnames]  # create a dataframe with the confidence interval odf = as.data.frame(best_values) odf$lower_bound <- exp( log(coef(fb_au)[vnames])-fb_au$err*1.96 ) odf$upper_bound <- exp( log(coef(fb_au)[vnames])+fb_au$err*1.96 ) odf$upper_bound[ fb_au$err > MAXCOEFVAR ] <- Inf odf <- round( odf, 3 )  #add the true values to data.frame odf[\"true_values\"] <- c(1.1, 0.9, NA) odf[\"Variable\"] <- c(\"alpha\", \"omega\", NA) odf$Variable <- as.factor(odf$Variable) ggplot(odf[1:2,], aes(x = Variable)) +   geom_point(aes(y = best_values), colour = \"black\", size = 3) +   geom_point(aes(y = true_values), colour = \"blue\", size = 3) +   geom_errorbar(aes(ymax = upper_bound, ymin = lower_bound,                      width = 0.5), colour = \"black\") +   facet_wrap( ~ Variable, scales = \"free\") +   theme_bw() +   xlab(\"True value\") +   ylab(\"Confidence Interval\") +   theme(text = element_text(size = 20), legend.position = \"bottom\")"},{"path":[]},{"path":"http://emvolz-phylodynamics.github.io/musseco/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Erik Volz. Author, maintainer. Fabricia F. Nascimento. Contributor.","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Volz E (2025). musseco: Multi-State Speciation Extinction Coalescent. R package version 0.1.0, https://github.com/emvolz-phylodynamics/musseco, http://emvolz-phylodynamics.github.io/musseco/.","code":"@Manual{,   title = {musseco: Multi-State Speciation and Extinction Coalescent},   author = {Erik Volz},   year = {2025},   note = {R package version 0.1.0, https://github.com/emvolz-phylodynamics/musseco},   url = {http://emvolz-phylodynamics.github.io/musseco/}, }"},{"path":"http://emvolz-phylodynamics.github.io/musseco/index.html","id":"musseco","dir":"","previous_headings":"","what":"Multi-State Speciation and Extinction Coalescent","title":"Multi-State Speciation and Extinction Coalescent","text":"musseco stands [Mu]lti-[S]tate [S]peciation [E]xtinction [Co]alescent R package estimate parameters speciation extinction coalescent process. implemented BiSSECo ([Bi]nary-[S]tate [S]peciation [E]xtinction [Co]alescent) model can estimate within-host -host replicative fitness using fixed time-scaled tree.","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Multi-State Speciation and Extinction Coalescent","text":"","code":"# You will need to install the R package devtools  # (https://github.com/r-lib/devtools)  install.packages(\"devtools\") devtools::install_github(\"emvolz-phylodynamics/musseco\")"},{"path":"http://emvolz-phylodynamics.github.io/musseco/index.html","id":"tutorials","dir":"","previous_headings":"","what":"Tutorials","title":"Multi-State Speciation and Extinction Coalescent","text":"recommend read Get started understand implementation BiSSeCO.","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/index.html","id":"author","dir":"","previous_headings":"","what":"Author","title":"Multi-State Speciation and Extinction Coalescent","text":"musseco developed Erik Volz","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/index.html","id":"related-softwares","dir":"","previous_headings":"","what":"Related softwares","title":"Multi-State Speciation and Extinction Coalescent","text":"musseco works fixed phylogenetic tree therefore program estimate tree .","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/fitbisseco.html","id":null,"dir":"Reference","previous_headings":"","what":"Fits the parameters of a BiSSeCo model by maximum likelihood — fitbisseco","title":"Fits the parameters of a BiSSeCo model by maximum likelihood — fitbisseco","text":"method estimates pair relative fitness coefficients pathogen phylogenies representing differences transmissibility differences within-host fitness. Relative fitness paramaterised 1) parameter \"alpha\" represents fold-change within-host replicative fitness 2) parameter \"omega\" represents fold-change -host replicative fitness. See details information.","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/fitbisseco.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fits the parameters of a BiSSeCo model by maximum likelihood — fitbisseco","text":"","code":"fitbisseco(   tr,   isvariant,   Tg,   mu,   Net = NULL,   theta0 = log(c(alpha = 15, omega = 0.95, yscale = 1)),   augment_likelihood = TRUE,   optim_parms = list(),   mlesky_parms = list(),   res = 200,   ... )"},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/fitbisseco.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fits the parameters of a BiSSeCo model by maximum likelihood — fitbisseco","text":"tr ape::phylo representing time-scaled phylogeny. can computed treedater package isvariant vector type boolean length equal ape::Ntip(tr). element TRUE corresponding element tr$tip.label variant type Tg Generation time, .e. mean time elapsed generations. Units variable match used tr$edge.length 1/mu, e.g. days years mu Molecular clock rate evolution Net NULL matrix two columns giving effective population size. NULL, effective population size computed mlesky package. first column time since point past, second column estimate effective population size. Time zero correspond root tree theta0 Initial guess (log) parameter values: alpha, omega, Ne scale. Can named vector aforementioned order. augment_likelihood TRUE (default), combine coalescent likelihood binomial likelihood sampling variants ancestral types assumption random sampling mutation-selection balance optim_parms optional list parameters passed optim fitting model mlesky_parms optional list parameters passed mlskygrid estimating Ne(t) res Integer number time steps used coalescent likelihood ... Additional parameters passed colik","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/fitbisseco.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fits the parameters of a BiSSeCo model by maximum likelihood — fitbisseco","text":"fitted BiSSeCo model coef summary methods","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/fitbisseco.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fits the parameters of a BiSSeCo model by maximum likelihood — fitbisseco","text":"Pathogen phylogenies assumed reconstructed population-based random samples pathogen genomes one sequence per host. Phylogenies time-scaled, estimate molecular clock rate evolution provided, estimated treedater package. provided, effective population size time estimated mlesky package, estimate also provided returned BiSSeCo fit.","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/fitbisseco.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fits the parameters of a BiSSeCo model by maximum likelihood — fitbisseco","text":"","code":"# load tree simulated with TiPS tr <- readRDS(system.file(\"extdata/tips_params_1_rep_2.rds\", package = \"musseco\"))  # set to TRUE tips that are from variant isvariant <- grepl( tr$tip.label, pattern = 'V_' ) isvariant <- setNames(isvariant, tr$tip.label)  #this will take a few minutes to run #the values of mu and Tg was based on true values used to simulate the trees #see vignette for more details. if (FALSE) { # \\dontrun{ fb_au <- fitbisseco( tr,                      isvariant,                      Tg = 10.2,                      mu = 0.0016,                      Net = NULL,                      theta0 = log(c(2,.75,1/2)),                      augment_likelihood = TRUE,                      optim_parms = list(),                      mlesky_parms = list(tau = NULL,                                          tau_lower = 0.1,                                          tau_upper = 1e7,                                          ncpu = 1,                                           model = 1 ) ) } # } # you can load the results from here load(system.file(\"extdata/fit.rda\", package = \"musseco\")) fb_au #> Binary state speciation and extinction coalescent fit #>  #>               2.5% 97.5% #> alpha  0.910 0.570 1.453 #> omega  0.918 0.874 0.964 #> yscale 0.844 0.769 0.926 #>  #> Likelihood: -5331.4195"},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/loglikelihood_bisseco.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the Likelihood of the BiSSeCo model — loglikelihood_bisseco","title":"Compute the Likelihood of the BiSSeCo model — loglikelihood_bisseco","text":"Likelihood BiSSeCo model given rates variant mutation, selection, dated tree, effective population size time","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/loglikelihood_bisseco.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the Likelihood of the BiSSeCo model — loglikelihood_bisseco","text":"","code":"loglikelihood_bisseco(   parms,   mu,   gamma,   dtr,   Net,   augment_likelihood = TRUE,   res = 200,   ... )"},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/loglikelihood_bisseco.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the Likelihood of the BiSSeCo model — loglikelihood_bisseco","text":"parms 3-vector containing parameters alpha (ratio substitution rate variant relative ancestral type), omega (relative fitness = 1+s) yscale (population size adjustment) mu Mean clock rate evolution gamma 1 / generation time dtr phydynR::DatedTree Net Effective population size time. stored two column augment_likelihood TRUE (default), combine coalescent likelihood binomial likelihood sampling variants ancestral types assumption random sampling mutation-selection balance res integer number time points used coalescent approximation matrix, first column time second column population size ... Additional parameters passed colik","code":""},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/musseco-package.html","id":null,"dir":"Reference","previous_headings":"","what":"musseco: Multi-State Speciation and Extinction Coalescent — musseco-package","title":"musseco: Multi-State Speciation and Extinction Coalescent — musseco-package","text":"Methods simulating genealogies estimating parameters speciation extinction coalescent process 1) disadvantageous alleles appear continuously population present mutation/selection balance; 2) non-equilibrium dynamics advantageous alleles appear continuously grow frequency.","code":""},{"path":[]},{"path":"http://emvolz-phylodynamics.github.io/musseco/reference/musseco-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"musseco: Multi-State Speciation and Extinction Coalescent — musseco-package","text":"Maintainer: Erik Volz erik@erikvolz.info (ORCID) contributors: Fabricia F. Nascimento thednainus@yahoo.com (ORCID) [contributor]","code":""}]
